/* ZD */
YUI.add("mytabview",function(a){function b(){b.superclass.constructor.apply(this,arguments)}var c="mytabview";b.NAME=c,b.ATTRS={circular:{value:!1},defSelection:{value:0},panelSelector:{value:""},panelNodes:{value:null},render:{value:!1},selection:{value:-1},srcNode:{setter:a.one,writeOnce:!0},tabSelector:{value:""},tabNodes:{value:null},hoverDelay:{value:-1},triggerEvent:{value:"click"}},a.extend(b,a.Base,{initializer:function(){this._srcNode=this.get("srcNode"),this.publish("switch"),this._tabEvents=[],this._panelSelector=this.get("panelSelector"),this._tabSelector=this.get("tabSelector"),this.set("panelNodes",this._srcNode.all(this._panelSelector)),this.set("tabNodes",this._srcNode.all(this._tabSelector)),this._CLS_TAB_VIEW=a.ClassNameManager.getClassName(c),this._CLS_TAB=a.ClassNameManager.getClassName(c,"tab"),this._CLS_TAB_LIST=a.ClassNameManager.getClassName(c,"tab","list"),this._CLS_TAB_SELECTED=a.ClassNameManager.getClassName(c,"tab","selected"),this._CLS_PANEL=a.ClassNameManager.getClassName(c,"panel"),this._CLS_PANEL_LIST=a.ClassNameManager.getClassName(c,"panel","list"),this._CLS_PANEL_SHOW=a.ClassNameManager.getClassName(c,"panel","show"),this.rendered=!1,this.get("render")&&this.render()},destructor:function(){for(;this._tabEvents.length;)this._tabEvents.pop().detach()},render:function(a){a&&(this.setAttrs(a),this._panelSelector=this.get("panelSelector"),this._tabSelector=this.get("tabSelector"),this.set("panelNodes",this._srcNode.all(this._panelSelector)),this.set("tabNodes",this._srcNode.all(this._tabSelector))),this.renderUI(),this.bindUI(),this.syncUI(),this.rendered=!0},renderUI:function(){this._renderCls()},bindUI:function(){return this._bindSelectionChange(),this._bindTrigger(),this},syncUI:function(){this._syncDefSelection()},next:function(a){var b=this.get("selection"),c=this.get("panelNodes").size()-1,d=b+1;"undefined"==typeof a&&(a=this.get("circular")),d=c>=d?d:a?0:b,this.switchTo(d)},prev:function(a){var b=this.get("selection"),c=this.get("panelNodes").size()-1,d=b-1;"undefined"==typeof a&&(a=this.get("circular")),d=d>=0?d:a?c:0,this.switchTo(d)},switchTo:function(a){this.set("selection",a)},_bindSelectionChange:function(){this._tabEvents.push(this.after("selectionChange",this._afterSelectionChange,this))},_bindTrigger:function(){var b=this.get("triggerEvent");"hover"===b?(this._hoverTimer=null,this._tabEvents.push(this._srcNode.delegate(b,a.bind(this._onTriggerMouseEnter,this),a.bind(this._onTriggerMouseLeave,this),this._tabSelector))):this._tabEvents.push(this._srcNode.delegate(b,this._onTriggerOtherEvent,this._tabSelector,this))},_hidePrevSelection:function(a){a.prevTab&&a.prevTab.removeClass(this._CLS_TAB_SELECTED),a.prevPanel&&a.prevPanel.removeClass(this._CLS_PANEL_SHOW)},_renderCls:function(){var a=this.get("srcNode"),b=this.get("tabNodes"),c=this.get("panelNodes");return a.addClass(this._CLS_TAB_VIEW),b.addClass(this._CLS_TAB),b.item(0).ancestor().addClass(this._CLS_TAB_LIST),c.addClass(this._CLS_PANEL),c.item(0).ancestor().addClass(this._CLS_PANEL_LIST),this},_showNewSelection:function(a){a.newTab&&a.newTab.addClass(this._CLS_TAB_SELECTED),a.newPanel&&a.newPanel.addClass(this._CLS_PANEL_SHOW)},_switchSelection:function(a){this._hidePrevSelection(a),this._showNewSelection(a)},_switchTo:function(a){var b=this.get("tabNodes"),c=this.get("panelNodes"),d=a.prevVal<0?null:b.item(a.prevVal),e=a.prevVal<0?null:c.item(a.prevVal),f=b.item(a.newVal),g=c.item(a.newVal),h={prevSelection:a.prevVal,newSelection:a.newVal,prevTab:d,newTab:f,prevPanel:e,newPanel:g};this._switchSelection(h),this.fire("switch",h)},_syncDefSelection:function(){var a=this.get("defSelection");a>=0&&this.switchTo(a)},_afterSelectionChange:function(a){this._switchTo(a)},_onTriggerOtherEvent:function(a){var b=a.currentTarget,c=this.get("tabNodes"),d=c.indexOf(b);this.switchTo(d)},_onTriggerMouseEnter:function(a){var b=a.currentTarget,c=this.get("tabNodes"),d=this.get("hoverDelay"),e=c.indexOf(b),f=this;d>0?(this._hoverTimer&&clearTimeout(this._hoverTimer),this._hoverTimer=setTimeout(function(){f.switchTo(e)},d)):this.switchTo(e)},_onTriggerMouseLeave:function(){this._hoverTimer&&clearTimeout(this._hoverTimer),this._hoverTimer=null}}),a.MyTabView=b},"1.0.0",{requires:["base","classnamemanager","node","event","event-delegate"]});