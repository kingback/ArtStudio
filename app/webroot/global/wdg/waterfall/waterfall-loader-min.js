/* ZD */
YUI.add("waterfall-loader",function(a){function b(){a.after(this.start,this,"render",this)}var c=a.one(a.config.win);b.ATTRS={loader:{}},b.prototype={initializer:function(){this._loader=this.get("loader"),this.loading=!1,this.publish("success"),this.publish("fail")},bindLoader:function(){var b=this;this._loader&&(this._loaderHandler=a.on(["scroll","resize"],a.throttle(function(){b.check()},50),a.config.win))},unbindLoader:function(){this._loaderHandler&&(this._loaderHandler.detach(),delete this._loaderHandler)},load:function(){var b=this._loader;b&&(this.loading=!0,b.call(this,a.bind(this.success,this),a.bind(this.fail,this)))},stop:function(){this.unbindLoader()},start:function(){this.bindLoader(),this.check()},check:function(){if(!this.loading&&!this.adding){var a=this.getShortList().node,b=a.get("region"),d=c.get("region");b.bottom<=d.bottom&&this.load()}},success:function(a){this.fire("success",{data:a}),this.add(a),this.loading=!1},fail:function(a){this.fire("fail",{msg:a}),this.loading=!1}},a.WaterfallLoader=b,a.Base.mix(a.Waterfall,[a.WaterfallLoader])},"0.0.1",{requires:["waterfall"]});