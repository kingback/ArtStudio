/* ZD */
YUI.add("slideshow",function(a){var b='<li data-id="{id}" data-index="{index}"><img src="{src}" title="{alt}" alt="{alt}" /></li>',c='<li data-id="{id}" data-index="{index}"><span><img src="{src}" title="{alt}" alt="{alt}" /></span></li>';a.SlideShow=a.Base.create("slideshow",a.Widget,[a.WidgetPosition,a.WidgetPositionAlign,a.WidgetModality,a.WidgetStack],{initializer:function(){this._data=this.get("data"),this.publish("select",{defaultFn:this._defSelectFn})},destructor:function(){},renderUI:function(){this._domCache(),this._renderWin(),this._renderNav(),this._renderInfo(),this._renderClose()},bindUI:function(){this.after("dataChange",this._afterDataChange),this.after("selectedItemChange",this._afterSelectedItemChange),this._cb.delegate("click",this._onItemClick,".yui3-slideshow-nav li",this),this._close.on("click",this.hide,this)},syncUI:function(){this.select(this.get("selected"))},select:function(b,c){a.Lang.isString(b)?b=this._getItemById(b):a.Lang.isNumber(b)&&(b=this._getItemByIndex(b)),b||(b=this._nav.one("li")),this.set("selectedItem",b,{anim:c})},_domCache:function(){this._bb=this.get("boundingBox"),this._cb=this.get("contentBox")},_createElem:function(b,c){var d=document.createElement(b),e=a.one(d);return e.addClass(this.getClassName(c)),e},_getItemById:function(a){var b=null;return this._nav.all("li").some(function(c){return c.getAttribute("data-id")===a?(b=c,!0):void 0}),b},_getItemByIndex:function(a){return this._nav.all("li").item(a)},_getWinByItem:function(a){return a?this._win.all("li").item(Number(a.getAttribute("data-index"))):null},_getDataByItem:function(a){return a?this._data.images[Number(a.getAttribute("data-index"))]:null},_renderWin:function(){var c="";this._win?this._win.empty(!0):(this._win=this._createElem("ul","win"),this._cb.append(this._win)),this._data&&(a.Array.each(this._data.images,function(d,e){c+=a.Lang.sub(b,{src:d.large,alt:d.desc,id:d.id,index:e})},this),this._win.append(c))},_renderNav:function(){var b="";this._nav?this._nav.empty(!0):(this._nav=this._createElem("ul","nav"),this._nav.addClass("clearfix"),this._cb.append(this._nav)),this._data&&(a.Array.each(this._data.images,function(d,e){b+=a.Lang.sub(c,{src:d.small,alt:d.desc,id:d.id,index:e})},this),this._nav.append(b))},_renderInfo:function(){this._info?this._info.setContent(""):(this._info=this._createElem("h3","info"),this._cb.append(this._info)),this._data&&this._info.setContent(this._data.title)},_renderClose:function(){this._close=this._createElem("span","close"),this._close.setContent("Ã—"),this._cb.append(this._close)},_onItemClick:function(a){this.select(a.currentTarget,!0)},_afterDataChange:function(a){this._data=a.newVal,this.set("selected",""),this.set("selectedItem",null,{reset:!0}),this._renderWin(),this._renderNav(),this._renderInfo(),this.syncUI()},_afterSelectedItemChange:function(a){a.reset||this.fire("select",{prevData:this._getDataByItem(a.preVal),prevWin:this._getWinByItem(a.prevVal),prevItem:a.prevVal,data:this._getDataByItem(a.newVal),win:this._getWinByItem(a.newVal),item:a.newVal,anim:a.anim})},_defSelectFn:function(a){a.prevItem&&a.prevItem.removeClass("yui3-slideshow-selected"),a.item&&a.item.addClass("yui3-slideshow-selected"),a.prevWin&&(a.prevWin.removeClass("yui3-slideshow-show"),a.anim?a.prevWin.transition({opacity:0,duration:.25}):a.prevWin.setStyle("opacity",0)),a.win&&(a.win.addClass("yui3-slideshow-show"),a.anim?a.win.transition({opacity:1,duration:.25}):a.win.setStyle("opacity",1))}},{ATTRS:{data:{value:null,validator:function(a){return!!a}},selectedItem:{value:null},selected:{value:""}}})},"0.0.1",{requires:["slideshow-skin","base","widget","widget-stack","widget-position","widget-position-align","widget-modality","transition"]});